{"version":3,"sources":["all.js"],"names":["firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","measurementId","Vue","firebase","data","music","load","id","file","video","loop","noclick","progress","start","mounted","this","getfile","methods","togglemusic","get","index","end","_this","some","item","num","fileUrl","indexOf","length","upload","_this2","$refs","files","size","type","undefined","alert","storage","ref","uploadTask","child","concat","name","put","on","snapshot","bytesTransferred","toFixed","split","totalBytes","getDownloadURL","then","downloadURL","total","database","push","_this3","updatefile","Object","values","val","querySelector","volume","play"],"mappings":"cAAA,WACE,GAAMA,IADPC,OAAA,0CACCC,WAAMF,gCACJC,YAAQ,uCACRC,UAAU,gBACVC,cAAa,4BACbC,kBAAW,eACXC,MAAAA,4CACAC,cAAAA,eAEAC,UAAAA,cAAeP,GARM,GAAvBQ,MAUAC,GAAAA,OACAC,KAXA,WAYI,OADIC,MAAA,GAGJC,KAAO,GACLD,GAAAA,EACAC,QACAC,SACAC,MAAI,EACJC,SAAM,EACNC,UACAC,MAAO,EACPC,MAAQ,EACNC,SADO,KARJC,QAdX,WAWQC,KAAAC,WAmBJC,SAnBIC,YAmBCF,SAnBDG,EAAAC,GAqBNH,KAASZ,MAAAc,EACPD,KAAAA,GADOE,EAELL,KAAKV,KAALC,QAEAe,IANGL,WAMH,GAAAM,GAAAP,IAJK,IAAAA,KAAAL,KAAA,OAAA,CAMPW,MANOZ,MAAAc,KAAA,SAAAC,EAMFC,GAEH,OAFG,IAAAD,EAAAE,QAAAC,QAAAL,EAAAjB,SAICiB,EAAKf,GAAKkB,IAFgB,IAAzBhB,EAAMc,QAAKI,QAAAL,EAAAjB,SAUhBU,KAAAR,GAAA,EAAAQ,KAAAN,MAAAmB,OAAA,GACAb,KAAAV,MAAAU,KAAAN,MAAA,GAAAiB,QAIEX,KAAKR,GAAK,IADVQ,KAAKV,MAAQU,KAAKN,MAAMM,KAAGW,GAA3B,GAAAA,QACAX,KAAKR,IAAL,GAGAQ,KAAAT,KAAAA,QAKJuB,OAjCKb,WAiCG,GAAAc,GAAAf,KACFP,EAAOO,KAAKgB,MAAMvB,KAAKwB,MAAM,EAHjC,QAAU1B,KAAVE,EAAA,OAAA,CA7BK,IAAAA,EAAAyB,KAAA,IAAA,IA+BC,MAARJ,OA/BO,kBA+BC,CAEN,IAA8B,QAA9BrB,EAAO0B,KAAKC,MAAAA,KAAW,GACvB,MAMEC,OAAM,mBANCH,CAEP,IAAAI,GAAAlC,SAAAkC,UAAAC,KACDvB,MAAAJ,SAAA,CAQD,IAAM4B,GAAaF,EAAQG,MAAR,OAAAC,OAAqBjC,EAAKkC,OAAQC,IAAInC,EARxD+B,GAAAK,GAAA,gBAAA,SAAAC,GAUCf,EAAKlB,SAASC,OAASgC,EAASC,iBAAmB,KAASC,QAAQ,GARtEjB,EAAGtB,SAAUwC,OAAWH,EAAOI,WAAO,KAAAF,QAAA,GACpCX,EAAKxB,SAACA,SAANiC,EAAAC,iBAAAD,EAAAI,WAAA,KACA,aACD,WAUCV,EAAWM,SAASP,IAAIY,iBAAiBC,KAAK,SAACC,GAVhDtB,EAAAtB,MACG6B,QAAUlC,EACTQ,KAALH,EAAekC,KACTH,KAAAA,EAAaF,KAAAA,MAAQG,KAAR,MAEjBW,KAAKvC,WACLkB,EAAKlB,SAASyC,MAAQ,EACtBvB,EAAKlB,SAASA,MAAd,EACCkB,EAAAlB,SAJHA,SAKG,EACD2B,EAAAA,kBAIIL,WA1DHlB,WAuDab,SAAZmD,WAAAhB,IAAA,SAAAiB,KAAAxC,KAAAP,MAKDO,KAAEoC,WAEDnC,QA9DDA,WA8DC,GAAAwC,GAAAzC,IACAZ,UAAAmD,WAAAhB,IAAA,SAWSM,GAAG,QAAS,SAACC,GAVtB,GAAA,OAAAA,EAAKY,MAAL,OAAA,CACDD,GAXD/C,MAAAiD,OAAAC,OAAAd,EAAAe,OANFJ,EAAAnD,MAAAmD,EAAA/C,MAAA,GAAAiB,QA9CK8B,EAAA7C,SAAA,EAkEP8C,EAAAA,UAlEO,WAmELtD,EAASmD,KAAAA,SAAeO,cAAc,WACtCL,EAAKxC,KAAL8C,OAAA,IApEKN,EAAAlD,KAAAyD,gBAyEH7D","file":"all.js","sourcesContent":["(function(){\r\n  const firebaseConfig = {\r\n    apiKey: \"AIzaSyCG97TbGDVQrMXrWAwX6BEomY0za-RwAHg\",\r\n    authDomain: \"testmp4-69da7.firebaseapp.com\",\r\n    databaseURL: \"https://testmp4-69da7.firebaseio.com\",\r\n    projectId: \"testmp4-69da7\",\r\n    storageBucket: \"testmp4-69da7.appspot.com\",\r\n    messagingSenderId: \"878000337213\",\r\n    appId: \"1:878000337213:web:f37eb95a024a7c79ae9554\",\r\n    measurementId: \"G-VEFZW9KSXQ\"\r\n  };\r\n  firebase.initializeApp(firebaseConfig);\r\n  new Vue({\r\n    el: '#app',\r\n    data() {\r\n      return {\r\n        music:'',\r\n        load:'',\r\n        id: 0,\r\n        file:{},\r\n        video:[],\r\n        loop:false,\r\n        noclick:false,\r\n        progress:{\r\n          start:0,\r\n          total:0,\r\n          progress:0,\r\n        },\r\n      }\r\n    },\r\n    mounted() {\r\n      this.getfile();\r\n    },\r\n    methods: {\r\n      togglemusic(get,index){\r\n        this.music = get;\r\n        this.id = index;\r\n        this.load.load();\r\n      },\r\n      end(){\r\n        if(this.loop) return false;\r\n        this.video.some((item,num) => {\r\n          if(item.fileUrl.indexOf(this.music) !== -1){\r\n            this.id = num;\r\n          }\r\n          return item.fileUrl.indexOf(this.music) !== -1;\r\n        });\r\n\r\n        // if(this.loop){\r\n        //   this.load.loop = true;\r\n        //   this.load.load();\r\n        //   return;\r\n        // }\r\n\r\n        if(this.id + 1 > this.video.length -1){\r\n          this.music = this.video[0].fileUrl;\r\n          this.id = 0;\r\n        }else{\r\n          this.music = this.video[this.id + 1].fileUrl;\r\n          this.id += 1;\r\n        }\r\n        // this.load.loop = false;\r\n        this.load.load();\r\n      },\r\n      upload(){\r\n        let file = this.$refs.file.files[0];\r\n        if(file === undefined) return false;\r\n        if((file.size / 1000000) > 100) {\r\n          alert('請勿上傳超過100MB檔案');\r\n          return false;\r\n        };\r\n\r\n        if(file.type.split('/')[1] !== 'mp4') {\r\n          alert('請勿上傳不是mp4格式的檔案');\r\n          return false;\r\n        };\r\n        let storage = firebase.storage().ref();\r\n        this.noclick = true;\r\n        const uploadTask = storage.child(`mp4/${file.name}`).put(file);\r\n        uploadTask.on('state_changed', (snapshot) => {\r\n          this.progress.start = (snapshot.bytesTransferred / 1000000).toFixed(1);\r\n          this.progress.total = (snapshot.totalBytes / 1000000).toFixed(1);\r\n          this.progress.progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 200;\r\n        }, () => {\r\n        }, () => {\r\n          uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {\r\n            this.file = {\r\n              fileUrl: downloadURL,\r\n              name: file.name,\r\n              type: file.type.split('/')[1],\r\n            };\r\n          }).then(() => {\r\n            this.progress.start = 0;\r\n            this.progress.total = 0;\r\n            this.progress.progress = 0;\r\n            this.updatefile();\r\n          });\r\n        });\r\n      },\r\n      updatefile(){\r\n        firebase.database().ref('/file').push(this.file);\r\n        this.getfile();\r\n      },\r\n      getfile(){\r\n        var starCountRef = firebase.database().ref('/file');\r\n        starCountRef.on('value', (snapshot) => {\r\n          if (snapshot.val() === null) return false;\r\n          this.video = Object.values(snapshot.val());\r\n          this.music = this.video[0].fileUrl;\r\n          this.noclick = false;\r\n          this.$nextTick(()=>{\r\n            this.load = document.querySelector('.video1');\r\n            this.load.volume = 0.25;\r\n            this.load.play();\r\n          })\r\n        });\r\n      }\r\n    },\r\n  })\r\n})(Vue)"]}